# -*- coding:utf-8 -*-

from czaSpider.dataBase.mongo_database.models import Mongodb
from czaSpider.dataBase.mongo_database.orm import get_mongo_client

test = [{'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}, {'处罚文号': '泰环罚决字[2016]17号', '被处罚者名称': '泰安市中医医院', '法人姓名': '陈  涛', '违法事实': '水污染物超标', '处罚依据': '《中华人民共和国水污染防治法》第74条', '处罚内容': '罚款11941.5元', '作出处罚时间': '2016年9月29日', '执行情况': '已执行', 'spiderName': 'IOCO', 'author': 'czaOrz', 'url': 'www.czaOrz.xyz', 'parse_time': None, 'source': [{'request': 'Bytes! save Done!', 'fid': '00155871420270873c1fbbc87ac442f9d4a326bd2cc7633000', 'size': 73823}], 'unique_flag': 'URL', 'download_finished': True}]


if __name__ == '__main__':
    if get_mongo_client():
        cza = Mongodb('test', 'downloadTest')
        # print(cza.source.findAll(download_finished=True).documents)
        # print(cza.source.findAll(parse_time=None).documents)

        # cza = Mongodb('test', 'hello-mongo')
        # print(cza.source.docs)  # todo, docs -- SUCCESS
        # print(cza.source.find(ne={"isok":False}).documents) # todo, find,documents -- SUCCESS
        # print(cza.source.findAll(field={"_id":1}).documents)  # todo, findAll -- SUCCESS
        # print(cza.source.pop(name='test1', db='redis').documents)  # todo, pop -- success
        # print(cza.source.update(name='test1', set={'age':20}).docs)
        # print(cza.source.updateAll(name='test1', set={"age":100}).docs)
        # print(cza.source.insert(name='test1', db='redis', age=30, isok=True).docs)  # todo, insert -- SUCCESS
        print(cza.source.insertAll(test).docs)
        # print(cza.source.removeAll(name='test1').docs)
        # cza.source.update(name="czaOrz", set={"name":"czaOrz", "hello":"world", "py":"mongo", "what":"do not cover?"})  # todo, update -- SUCCESS
        # cza.source.drop()


